@{
    Layout = null;
}
@*半小时收费*@
<link href="~/Content/bootstrap.css" rel="stylesheet" />
<link href="~/Content/bootstrap-timepicker.min.css" rel="stylesheet" />
<link href="~/Content/bootstrap-theme.css" rel="stylesheet" />
<link href="~/Content/font-awesome.css" rel="stylesheet" />
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script src="~/Scripts/bootstrap.min.js"></script>
<script src="~/Scripts/bootstrap-timepicker.min.js"></script>
@*<script src="~/Scripts/jquery.validate.js"></script>*@
<script src="~/Scripts/common.js"></script>

<style>
    .textAlignRight {
        text-align: right;
    }

    .h30 {
        height: 30px;
        margin-bottom: 10px;
        color: #6C7A8B;
    }
    label, select, .task-title {
        color: #6C7A8B;
    }

    .input-group-addon {
        background-color: #E8F6FF;
        border: 1px solid #E7E9ED;
        color: #6C7A8B;
    }

    input.form-control {
        border: 1px solid #E7E9ED;
        color: #0092FF;
        text-align: center;
    }

    .panel {
        border-radius: 0px;
    }
    li {
        list-style:none;
        margin-top:5px;
    }
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        -webkit-appearance: none;
    }

    input[type="number"] {
        -moz-appearance: textfield;
    }
</style>
<form id="form" method="post" action="#" onsubmit="parent.SaveBtn();return false;">
    <div style="height:0;overflow: hidden;"><input type="submit" value="submit" /></div>
    <div style="margin-left:30px;width:100%;overflow:auto;height:100vh">
        <div id="" style="margin-left:20px">
            <div class="panel panel-primary" style="margin:0px -20px; border-color: #e7e9ed;">
                <div style="color: #6C7A8B; background-color: #f3f8fb; border-color: #e7e9ed;">
                    <label style="margin-left:10px;margin-top:5px;font-size:12px">公共设置</label>
                </div>
                <div class="panel-body" style="padding-bottom: 10px;">
                    <!--公共设置-->
                    <input id="TemplateModelName" value="TemplateModelName" class="hidden" />
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group validateinput h30">
                                <label class="col-md-4 control-label textAlignRight">白天时段</label>
                                <div class="col-md-5 input-group">
                                    <div class="bootstrap-timepicker timepicker">
                                        <input id="DayBeginTime" type="text" class="form-control datetimepicker3 font-size-12" data-theme="DayBeginTime" name="DayBeginTime" value="" style="height:30px;width:70px">
                                    </div>
                                    <span class="input-group-addon" style="font-size:12px;height:26px">至</span>
                                    <div class="bootstrap-timepicker timepicker">
                                        <input id="DayEndTime" type="text" class="form-control datetimepicker3 font-size-12" data-theme="DayEndTime" name="DayEndTime" value="" style="height:30px;width:70px">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group validateinput h30">
                                <label class="col-md-4 control-label textAlignRight">免费分钟</label>
                                <div class="col-md-5 input-group">
                                    <input type="number" name="FreeMinutes" id="FreeMinutes" class="form-control required NumText MaxNumHaxText input-sm" min="0" max="255" value="30">
                                    <span class="input-group-addon">分</span>
                                </div>
                            </div>
                            <div class="form-group validateinput h30">
                                <label class="col-md-4 control-label textAlignRight">超时分钟</label>
                                <div class="col-md-5 input-group">
                                    <input class="form-control required MaxNumDecText NumText input-sm" type="number" min="0" max="65535" id="TimeOut" name="TimeOut" value="30">
                                    <span class="input-group-addon">分</span>
                                </div>
                            </div>
                            <div class="form-group validateinput h30">
                                <label class="col-md-4 control-label textAlignRight">离场超时时间</label>
                                <div class="col-md-5 input-group">
                                    <input class="form-control required NumText MaxNumHaxText input-sm" type="number" min="0" max="65535" id="LeaveTimeout" name="LeaveTimeout" value="30">
                                    <span class="input-group-addon">分</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group validateinput h30">
                                <label class="col-md-5 control-label textAlignRight">计费单位</label>
                                <div class="col-md-7 radio-list">
                                    <label class="radio-inline">
                                        <input name="MonetaryUnit" id="Unit1" value="1" type="radio" onclick="change()" checked><span class="font-size-12">元</span>
                                    </label>
                                    <label class="radio-inline">
                                        <input name="MonetaryUnit" id="Unit2" value="0" type="radio" onclick="change()"> <span class="font-size-12">角</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group validateinput h30">
                                <label class="col-md-5 control-label textAlignRight">24小时最高收费</label>
                                <div class="col-md-5 input-group">
                                    <input type="number" name="DayTopLimit" id="DayTopLimit" class="form-control NumText input-sm MaxNumText required" min="0" max="65535" value="65535">
                                    <span class="input-group-addon classunit">元</span>
                                </div>
                            </div>
                            <div class="form-group validateinput h30">
                                <label class="col-md-5 control-label textAlignRight">本次最高收费</label>
                                <div class="col-md-5 input-group">
                                    <input type="number" name="AmountTopLimit" id="AmountTopLimit" class="form-control NumText input-sm MaxNumText required" min="0" max="65535" value="65535">
                                    <span class="input-group-addon classunit">元</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="tasks-widget" style="padding-left: 80px;">
                            <ul class="task-list list-padding--2">
                                <li>
                                    <div class="task-checkbox" style="float:left;margin-right:5px;">
                                        <div class="checker">
                                            <span id="SpFeeSet1">
                                                <input type="checkbox" id="FeeSet1" name="FeeSet1" class="liChild" value="" onclick="FeeSet1Checked()">
                                            </span>
                                        </div>
                                    </div>
                                    <div class="task-title">
                                        <span class="task-title-sp font-color-000 font-size-12">
                                            超过1天后，剩余不足1天时间白天无前1小时收费，直接按每1个半小时收费
                                        </span>
                                    </div>
                                </li>
                                <li>
                                    <div class="task-checkbox" style="float:left;margin-right:5px;">
                                        <div class="checker">
                                            <span id="SpFeeSet2">
                                                <input type="checkbox" id="FeeSet2" name="FeeSet2" class="liChild" value="" onclick="FeeSet2Checked()">
                                            </span>
                                        </div>
                                    </div>
                                    <div class="task-title">
                                        <span class="task-title-sp font-color-000 font-size-12">
                                            超过1天后，剩余不足1天时间晚上无前1小时收费，直接按每1个半小时收费
                                        </span>
                                    </div>
                                </li>
                                <li>
                                    <div class="task-checkbox" style="float:left;margin-right:5px;">
                                        <div class="checker">
                                            <span id="SpFeeSet3">
                                                <input type="checkbox" id="FeeSet3" name="FeeSet3" class="liChild" value="" onclick="FeeSet3Checked()">
                                            </span>
                                        </div>
                                    </div>
                                    <div class="task-title">
                                        <span class="task-title-sp font-color-000 font-size-12">
                                            去掉免费分钟后再计算费用
                                        </span>
                                    </div>
                                </li>
                                <li>
                                    <div class="task-checkbox" style="float:left;margin-right:5px;">
                                        <div class="checker">
                                            <span id="SpFeeSet4">
                                                <input type="checkbox" id="FeeSet4" name="FeeSet4" class="liChild" value="" onclick="FeeSet4Checked()">
                                            </span>
                                        </div>
                                    </div>
                                    <div class="task-title">
                                        <span class="task-title-sp font-color-000 font-size-12">
                                            无分段，按白天段处理
                                        </span>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel panel-primary " style="margin: 0px -20px; border-color: #e7e9ed;">
                <div style="color: #6C7A8B; background-color: #f3f8fb; border-color: #e7e9ed;">
                    <label style="margin-left:10px;margin-top:5px;font-size:12px">白天时段内设置</label>
                </div>
                <div class="panel-body" style="padding-bottom: 10px;">
                    <!--白天时段内设置-->
                    <div class="row">
                        <div class="col-md-4 padding-right-0">
                            <div class="form-group validateinput h30">
                                <label class="col-md-3 control-label textAlignRight">首</label>
                                <div class="col-md-5 input-group">
                                    <input type="number" class="form-control NumText MaxNumHaxText input-sm required" name="DayFirstHalfHour" id="DayFirstHalfHour" min="1" max="255" value="1">
                                </div>
                                <label class="col-md-4 control-label font-size-12">个半小时</label>
                            </div>
                            <div class="form-group validateinput h30">
                                <label class="col-md-3 control-label textAlignRight">以后</label>
                                <div class="col-md-5 input-group">
                                    <input type="number" class="form-control NumText MaxNumHaxText input-sm required" name="DayNextHalfHour" id="DayNextHalfHour" min="0" max="255" value="1">
                                </div>
                                <label class="col-md-4 control-label font-size-12">个半小时</label>
                            </div>

                        </div>

                        <div class="col-md-4 padding-left-right-0">
                            <div class="form-group validateinput h30">
                                <label class="col-md-4 control-label textAlignRight">收费</label>
                                <div class="col-md-6 input-group">
                                    <input type="number" class="form-control NumText MaxNumHaxText input-sm required" name="DayFirstMoney" id="DayFirstMoney" min="0" max="255" value="5">
                                    <span class="input-group-addon classunit">元</span>
                                </div>
                            </div>
                            <div class="form-group validateinput h30">
                                <label class="col-md-4 control-label textAlignRight">收费</label>
                                <div class="col-md-6 input-group">
                                    <input type="number" class="form-control NumText MaxNumHaxText input-sm required" name="DayNextMoney" id="DayNextMoney" min="0" max="255" value="10">
                                    <span class="input-group-addon classunit">元</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 padding-left-0">
                            <div class="form-group validateinput h30">
                                <div class="row">
                                    <label class="col-md-4 control-label" style="font-size:15px">&nbsp;</label>
                                </div>
                            </div>
                            <div class="form-group validateinput h30">
                                <div class="row">
                                    <label class="col-md-4 control-label textAlignRight">最高收费</label>
                                    <div class="col-md-6 input-group">
                                        <input type="number" class="form-control NumText MaxNumHaxText input-sm required" name="DayMaxMoney" id="DayMaxMoney" min="0" max="255" value="255">
                                        <span class="input-group-addon classunit">元</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel panel-primary" style="margin: 0px -20px; border-color: #e7e9ed;">
                <div style="color: #6C7A8B; background-color: #f3f8fb; border-color: #e7e9ed;">
                    <label style="margin-left:10px;margin-top:5px;font-size:12px">晚上时段内设置</label>
                </div>
                <div class="panel-body" style="padding-bottom: 10px;">
                    <!--晚上时段内收费设置-->
                    <div class="row">
                        <div class="col-md-4 padding-right-0">
                            <div class="form-group validateinput h30">
                                <label class="col-md-3 control-label textAlignRight">首</label>
                                <div class="col-md-5 input-group">
                                    <input type="number" class="form-control NumText MaxNumHaxText input-sm required" name="NightFirstHalfHour" id="NightFirstHalfHour" min="1" max="255" value="1">
                                </div>
                                <label class="col-md-4 control-label font-size-12">个半小时</label>
                            </div>
                            <div class="form-group validateinput h30">
                                <label class="col-md-3 control-label textAlignRight">以后</label>
                                <div class="col-md-5 input-group">
                                    <input type="number" class="form-control NumText MaxNumHaxText input-sm required" name="NightNextHalfHour" id="NightNextHalfHour" min="0" max="255" value="1">
                                </div>
                                <label class="col-md-4 control-label font-size-12">个半小时</label>
                            </div>
                        </div>

                        <div class="col-md-4" style="padding-left: 0px; padding-right: 0px;">
                            <div class="form-group validateinput h30">
                                <label class="col-md-4 control-label textAlignRight">收费</label>
                                <div class="col-md-6 input-group">
                                    <input type="number" class="form-control NumText MaxNumHaxText input-sm required" name="NightFirstMoney" id="NightFirstMoney" min="0" max="255" value="5">
                                    <span class="input-group-addon classunit">元</span>
                                </div>
                            </div>
                            <div class="form-group validateinput h30">
                                <label class="col-md-4 control-label textAlignRight">收费</label>
                                <div class="col-md-6 input-group">
                                    <input type="number" class="form-control NumText MaxNumHaxText input-sm required" name="NightNextMoney" id="NightNextMoney" min="0" max="255" value="10">
                                    <span class="input-group-addon classunit">元</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 padding-left-0">
                            <div class="form-group validateinput h30">
                                <div class="row">
                                    <label class="col-md-4 control-label" style="font-size:15px">&nbsp;</label>
                                </div>
                            </div>
                            <div class="form-group validateinput h30">
                                <div class="row">
                                    <label class="col-md-4 control-label textAlignRight">最高收费</label>
                                    <div class="col-md-6 input-group">
                                        <input type="number" class="form-control NumText MaxNumHaxText input-sm required" name="NightMaxMoney" id="NightMaxMoney" min="0" max="255" value="255">
                                        <span class="input-group-addon classunit">元</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div></form>
<script>
    $('.datetimepicker3').timepicker({
        minuteStep: 1,
        maxHours: 24,
        showMeridian: false,
        secondStep: 1,
        showSeconds: false,
    });
    function FeeSet1Checked() {
        $("#FeeSet1").val("1")
        $("#FeeSet1:checked").val("0")
    }
    function FeeSet2Checked() {
        $("#FeeSet2").val("1")
        $("#FeeSet2:checked").val("0")
    }
    function FeeSet3Checked() {
        $("#FeeSet3").val("1")
        $("#FeeSet3:checked").val("0")
    }
    function FeeSet4Checked() {
        $("#FeeSet4").val("1")
        $("#FeeSet4:checked").val("0")
    }
</script>
<script>
    //获取carTypeGuid
    var url = location.href
    var num = url.split("?")[1]
    var carTypeGuid = num.split("=")[1]
    $.ajax({
        url: "/Home/Maps/ParkLot/GetBillingTemplate?CarTypeGuid=" + carTypeGuid,
        dataType: 'json',
        method: 'GET',
        contentType: "application/json;charset=utf-8",
        success: function (res) {
            if (res.IsSuccess == true) {
                //请求成功判断是新增还是修改
                if (res.Result !== null) {
                    //修改
                    $("#form").attr("flag", "1")
                } else {
                    //新增
                    $("#form").attr("flag", "0")
                }
                if (res.Result !== null) {
                    if (res.Result.ChargeMode == 8) {
                        var data = JSON.parse(res.Result.TemplateJson)
                        var MonetaryUnit = data.MonetaryUnit;
                        if ($("input[name=MonetaryUnit]").eq(0).val() == MonetaryUnit) {
                            $("input[name=MonetaryUnit]").eq(0).prop("checked", true)
                            $("input[name=MonetaryUnit]").eq(1).prop("checked", false)
                            change()
                        } else if ($("input[name=MonetaryUnit]").eq(1).val() == MonetaryUnit) {
                            $("input[name=MonetaryUnit]").eq(1).prop("checked", true)
                            $("input[name=MonetaryUnit]").eq(0).prop("checked", false)
                            change()
                        }

                        $("#FreeMinutes").val(data.FreeMinutes)
                        $("#DayBeginTime").val(data.DayBeginTime)
                        $("#DayEndTime").val(data.DayEndTime)
                        $("#DayFirstHalfHour").val(data.DayFirstHalfHour)
                        $("#DayFirstMoney").val(data.DayFirstMoney)
                        $("#DayNextHalfHour").val(data.DayNextHalfHour)
                        $("#DayNextMoney").val(data.DayNextMoney)
                        $("#DayMaxMoney").val(data.DayMaxMoney)
                        $("#NightFirstHalfHour").val(data.NightFirstHalfHour)
                        $("#NightFirstMoney").val(data.NightFirstMoney)
                        $("#NightNextHalfHour").val(data.NightNextHalfHour)
                        $("#NightNextMoney").val(data.NightNextMoney)
                        $("#NightMaxMoney").val(data.NightMaxMoney)
                        $("#AmountTopLimit").val(data.AmountTopLimit)
                        $("#DayTopLimit").val(data.DayTopLimit)
                        $("#FeeSet1").val(data.FeeSet1)
                        if (data.FeeSet1 == "0") {
                            $("#FeeSet1").prop("checked", true)
                        } else if (!data.FeeSet1) {
                            $("#FeeSet1").prop("checked", false)
                            $("#FeeSet1").val("1")
                        }
                        $("#FeeSet2").val(data.FeeSet2)
                        if (data.FeeSet2 == "0") {
                            $("#FeeSet2").prop("checked", true)
                        } else if (!data.FeeSet2) {
                            $("#FeeSet2").prop("checked", false)
                            $("#FeeSet2").val("1")
                        }
                        $("#FeeSet3").val(data.FeeSet3)
                        if (data.FeeSet3 == "0") {
                            $("#FeeSet3").prop("checked", true)
                        } else if (!data.FeeSet3) {
                            $("#FeeSet3").prop("checked", false)
                            $("#FeeSet3").val("1")
                        }
                        $("#FeeSet4").val(data.FeeSet4)
                        if (data.FeeSet4 == "0") {
                            $("#FeeSet4").prop("checked", true)
                        } else if (!data.FeeSet4) {
                            $("#FeeSet4").prop("checked", false)
                            $("#FeeSet4").val("1")
                        }
                        $("#TimeOut").val(data.TimeOut)
                        $("#LeaveTimeout").val(data.LeaveTimeout)
                    }
                }
            }

        }
    })
    function change() {
        var value = $("input[name='MonetaryUnit']:checked").parent().find("span").html();
        $(".classunit").html(value);
    }
</script>